---
title: "Trivyã§Kubernetesã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã‚‹"
emoji: "ğŸŒŠ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Kubernetes", "Trivy", "Tech", "Kustomize"]
published: true
---

TrivyãŒã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ãƒ„ãƒ¼ãƒ«ã ã¨ã°ã‹ã‚Šæ€ã£ã¦ã„ã¾ã—ãŸãŒ
"Simplify Cloud Native Security with Trivy" ã§ã®ç™»å£‡ã‚’èã„ã¦ã€ã§ãã‚‹ã“ã¨ãŒã‹ãªã‚Šå¢—ãˆã¦ãã†ã ã£ãŸã®ã§ã€è§¦ã£ã¦ã¿ã¾ã—ãŸã€‚

æ™®æ®µã¯ã€Kuberneteså‘¨ã‚Šã®ã“ã¨ã‚’ä¸»ã«å–ã‚Šçµ„ã‚“ã§ã„ã‚‹ã®ã§ã€Kubernetesé–¢é€£ã§ã§ãã‚‹ã“ã¨ã‚’è©¦ãã†ã¨æ€ã„ã¾ã™ã€‚

## è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³

çš†ã•ã‚“ã”å­˜çŸ¥ã ã¨æ€ã‚ã‚Œã¾ã™ãŒã€ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã®è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ã§
[Quick Start](https://github.com/aquasecurity/trivy#quick-start)ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ãŸã€‚

ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸(python:3.4-alpine)ã«å­˜åœ¨ã™ã‚‹è„†å¼±æ€§ã‚’å‡ºåŠ›ã—ã¦ãã‚Œã¦ã„ã¾ã™ã€‚

```bash
$ trivy image python:3.4-alpine
2022-08-27T16:46:23.051+0900    INFO    Vulnerability scanning is enabled
2022-08-27T16:46:23.051+0900    INFO    Secret scanning is enabled
2022-08-27T16:46:23.051+0900    INFO    If your scanning is slow, please try '--security-checks vuln' to disable secret scanning
2022-08-27T16:46:23.051+0900    INFO    Please see also https://aquasecurity.github.io/trivy/v0.31.2/docs/secret/scanning/#recommendation for faster secret detection
2022-08-27T16:46:25.589+0900    INFO    Detected OS: alpine
2022-08-27T16:46:25.589+0900    INFO    Detecting Alpine vulnerabilities...
2022-08-27T16:46:25.591+0900    INFO    Number of language-specific files: 1
2022-08-27T16:46:25.591+0900    INFO    Detecting python-pkg vulnerabilities...
2022-08-27T16:46:25.595+0900    WARN    This OS version is no longer supported by the distribution: alpine 3.9.2
2022-08-27T16:46:25.595+0900    WARN    The vulnerability detection may be insufficient because security updates are not provided

python:3.4-alpine (alpine 3.9.2)

Total: 37 (UNKNOWN: 0, LOW: 4, MEDIUM: 16, HIGH: 13, CRITICAL: 4)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Library    â”‚ Vulnerability  â”‚ Severity â”‚ Installed Version â”‚ Fixed Version â”‚                            Title                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ expat        â”‚ CVE-2018-20843 â”‚ HIGH     â”‚ 2.2.6-r0          â”‚ 2.2.7-r0      â”‚ expat: large number of colons in input makes parser consume  â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ high amount...                                               â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2018-20843                   â”‚
â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚ CVE-2019-15903 â”‚          â”‚                   â”‚ 2.2.7-r1      â”‚ expat: heap-based buffer over-read via crafted XML input     â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2019-15903                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ libbz2       â”‚ CVE-2019-12900 â”‚ CRITICAL â”‚ 1.0.6-r6          â”‚ 1.0.6-r7      â”‚ bzip2: out-of-bounds write in function BZ2_decompress        â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2019-12900                   â”‚
...
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ sqlite-libs  â”‚ CVE-2019-8457  â”‚ CRITICAL â”‚ 3.26.0-r3         â”‚ 3.28.0-r0     â”‚ sqlite: heap out-of-bound read in function rtreenode()       â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2019-8457                    â”‚
â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚ CVE-2019-19244 â”‚ HIGH     â”‚                   â”‚ 3.28.0-r2     â”‚ sqlite: allows a crash if a sub-select uses both DISTINCT    â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ and window...                                                â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2019-19244                   â”‚
â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚ CVE-2019-5018  â”‚          â”‚                   â”‚ 3.28.0-r0     â”‚ sqlite: Use-after-free in window function leading to remote  â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ code execution                                               â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2019-5018                    â”‚
â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚ CVE-2020-11655 â”‚          â”‚                   â”‚ 3.28.0-r3     â”‚ sqlite: malformed window-function query leads to DoS         â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2020-11655                   â”‚
â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚ CVE-2019-16168 â”‚ MEDIUM   â”‚                   â”‚ 3.28.0-r1     â”‚ sqlite: Division by zero in whereLoopAddBtreeIndex in        â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ sqlite3.c                                                    â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2019-16168                   â”‚
â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚ CVE-2019-19242 â”‚          â”‚                   â”‚ 3.28.0-r2     â”‚ sqlite: SQL injection in sqlite3ExprCodeTarget in expr.c     â”‚
â”‚              â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2019-19242                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2022-08-27T16:46:25.613+0900    INFO    Table result includes only package filenames. Use '--format json' option to get the full path to the package file.

Python (python-pkg)

Total: 2 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 1, CRITICAL: 0)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Library     â”‚ Vulnerability  â”‚ Severity â”‚ Installed Version â”‚ Fixed Version â”‚                            Title                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pip (METADATA) â”‚ CVE-2019-20916 â”‚ HIGH     â”‚ 19.0.3            â”‚ 19.2          â”‚ python-pip: directory traversal in _download_http_url()     â”‚
â”‚                â”‚                â”‚          â”‚                   â”‚               â”‚ function in src/pip/_internal/download.py                   â”‚
â”‚                â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2019-20916                  â”‚
â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                â”‚ CVE-2021-3572  â”‚ MEDIUM   â”‚                   â”‚ 21.1          â”‚ python-pip: Incorrect handling of unicode separators in git â”‚
â”‚                â”‚                â”‚          â”‚                   â”‚               â”‚ references                                                  â”‚
â”‚                â”‚                â”‚          â”‚                   â”‚               â”‚ https://avd.aquasec.com/nvd/cve-2021-3572                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

[è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³](https://aquasecurity.github.io/trivy/v0.31.2/docs/vulnerability/scanning/)ã‚‚ã§ãã‚‹ã“ã¨ãŒå¢—ãˆã¦ã„ã¦
Container Image, Filesystem, Rootfs, Git Repositoryã®è„†å¼±æ€§ã‚’è¦‹ã¤ã‘ã¦ãã‚Œã¾ã™ã€‚


## [Misconfigurationã‚¹ã‚­ãƒ£ãƒ³](https://aquasecurity.github.io/trivy/v0.31.2/docs/misconfiguration/scanning/)

Terraform, CloudFormation, Dockerfile ã®ã‚ˆã†ãªIaCãƒ•ã‚¡ã‚¤ãƒ«ã®Misconfigurationã‚’è¦‹ã¤ã‘ã¦ãã‚Œã¦ã€Kubernetes manifest ã§ã‚‚ç¢ºèªã§ãã¾ã—ãŸã€‚
ä»¥ä¸‹ã§ã¯ã€Kubernetes ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹[Deploymentã‚’ä½œæˆ](https://kubernetes.io/ja/docs/concepts/workloads/controllers/deployment/#creating-a-deployment)ã™ã‚‹ãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚³ãƒ”ãƒšã—ã¦ããŸDeploymentã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ã„ã¾ã™ã€‚

KustomizeåŒ–ã—ã¦ã—ã¾ã£ã¦ã„ã¾ã™ãŒã€ä»¥ä¸‹ã«Public Repository ã¨ã—ã¦å…¬é–‹ã—ãŸã®ã§ã€ã‚ˆã‹ã£ãŸã‚‰ä½¿ã£ã¦ãã ã•ã„ã€‚
https://github.com/dubs11kt/trivy-sample

```bash
$ pwd
/Users/dubs11kt/git/trivy-sample

$ trivy config  .
2022-08-27T16:56:02.609+0900    INFO    Misconfiguration scanning is enabled
2022-08-27T16:56:02.794+0900    INFO    Detected config files: 3

kustomize/base/deployment.yaml (kubernetes)

Tests: 78 (SUCCESSES: 66, FAILURES: 12, EXCEPTIONS: 0)
Failures: 12 (UNKNOWN: 0, LOW: 10, MEDIUM: 2, HIGH: 0, CRITICAL: 0)

MEDIUM: Container 'nginx' of Deployment 'nginx-deployment' should set 'securityContext.allowPrivilegeEscalation' to false
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 kustomize/base/deployment.yaml:18-21
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  18 â”Œ       - name: nginx
  19 â”‚         image: nginx:1.14.2
  20 â”‚         ports:
  21 â””         - containerPort: 80
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
...
```

å‡ºåŠ›ã•ã‚ŒãŸã‚‚ã®ã‹ã‚‰åˆ†ã‹ã‚‹é€šã‚Šã€78ä»¶ãƒ†ã‚¹ãƒˆã•ã‚Œã€12ä»¶å ±å‘Šã•ã‚Œã¦ã„ã¾ã™ã€‚

```
Tests: 78 (SUCCESSES: 66, FAILURES: 12, EXCEPTIONS: 0)
Failures: 12 (UNKNOWN: 0, LOW: 10, MEDIUM: 2, HIGH: 0, CRITICAL: 0)
```

ä¸Šè¨˜ã®ã‚³ãƒãƒ³ãƒ‰çµæœã®1ã¤ã‚’è¦‹ã¦ã¿ã‚‹ã¨
nginx-deployment ã® nginx ã‚³ãƒ³ãƒ†ãƒŠã«`securityContext.allowPrivilegeEscalation`ã‚’false ã«è¨­å®šã™ã‚‹ã¹ãã¨ã‚ã‚Šã¾ã™ã€‚
[Configure a Security Context for a Pod or Container](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)ã«ã‚ã‚‹é€šã‚Š
ãƒ—ãƒ­ã‚»ã‚¹ãŒè¦ªãƒ—ãƒ­ã‚»ã‚¹ã‚ˆã‚Šå¤šãã®ç‰¹æ¨©ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã©ã†ã‹ã‚’åˆ¶å¾¡ã™ã‚‹è¨­å®šã¨ãªã‚Šã¾ã™ã®ã§ã€ã§ãã‚‹é™ã‚Š`false`ã«ã™ã¹ãã§ã™ã€‚
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯`true`ã¨ãªã‚Šã¾ã™ã®ã§ã€æ˜ç¤ºçš„ã«`false`ã‚’è¨­å®šã—ã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚


# [Kubernetes Clusterã®ã‚¹ã‚­ãƒ£ãƒ³](https://aquasecurity.github.io/trivy/v0.31.2/docs/kubernetes/cli/scanning/)

Kubernetes Clusterã®è„†å¼±æ€§ã€Misconfigurationã€Secrets?(ã‚ˆãã‚ã‹ã£ã¦ãªã„)ã®ã‚¹ã‚­ãƒ£ãƒ³ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚
kind ã§ç«‹ã¦ãŸClusterå…¨ä½“ã«ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿæ–½ã—ã¦ã¿ã¾ã—ãŸã€‚

```bash
$ trivy k8s --report=summary cluster

163 / 163 [------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% 4 p/s

Summary Report for kind-kind
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Namespace      â”‚                    Resource                    â”‚     Vulnerabilities     â”‚ Misconfigurations  â”‚      Secrets      â”‚
â”‚                    â”‚                                                â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¤
â”‚                    â”‚                                                â”‚ C  â”‚  H  â”‚ M  â”‚  L  â”‚ U â”‚ C â”‚ H â”‚ M â”‚ L  â”‚ U â”‚ C â”‚ H â”‚ M â”‚ L â”‚ U â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ local-path-storage â”‚ Deployment/local-path-provisioner              â”‚ 4  â”‚  6  â”‚ 6  â”‚ 11  â”‚ 3 â”‚   â”‚   â”‚ 2 â”‚ 10 â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system        â”‚ Pod/kube-apiserver-kind-control-plane          â”‚    â”‚  1  â”‚ 4  â”‚ 19  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system        â”‚ Deployment/coredns                             â”‚    â”‚  4  â”‚ 1  â”‚     â”‚ 2 â”‚   â”‚   â”‚ 3 â”‚ 5  â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system        â”‚ Pod/kube-scheduler-kind-control-plane          â”‚    â”‚  1  â”‚ 3  â”‚ 9   â”‚   â”‚   â”‚   â”‚   â”‚    â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system        â”‚ DaemonSet/kube-proxy                           â”‚ 7  â”‚ 11  â”‚ 3  â”‚ 56  â”‚   â”‚   â”‚ 2 â”‚ 4 â”‚ 10 â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system        â”‚ Service/kube-dns                               â”‚    â”‚     â”‚ 1  â”‚     â”‚   â”‚   â”‚   â”‚   â”‚    â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system        â”‚ DaemonSet/kindnet                              â”‚ 8  â”‚ 11  â”‚ 4  â”‚ 56  â”‚ 1 â”‚   â”‚ 1 â”‚ 5 â”‚ 6  â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system        â”‚ Pod/kube-controller-manager-kind-control-plane â”‚    â”‚  1  â”‚ 3  â”‚ 11  â”‚   â”‚   â”‚   â”‚   â”‚    â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system        â”‚ Pod/etcd-kind-control-plane                    â”‚    â”‚ 12  â”‚ 4  â”‚     â”‚ 4 â”‚   â”‚ 1 â”‚ 3 â”‚ 7  â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ default            â”‚ Deployment/nginx-deployment                    â”‚ 56 â”‚ 106 â”‚ 86 â”‚ 159 â”‚ 7 â”‚   â”‚   â”‚ 2 â”‚ 10 â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN


Summary Report for kind-kind
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Namespace  â”‚                            Resource                             â”‚  RBAC Assessment  â”‚
â”‚             â”‚                                                                 â”œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¤
â”‚             â”‚                                                                 â”‚ C â”‚ H â”‚ M â”‚ L â”‚ U â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤
â”‚ kube-system â”‚ Role/system::leader-locking-kube-controller-manager             â”‚   â”‚   â”‚ 1 â”‚   â”‚   â”‚
â”‚ kube-system â”‚ Role/system:controller:bootstrap-signer                         â”‚ 1 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system â”‚ Role/system:controller:token-cleaner                            â”‚ 1 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚ kube-system â”‚ Role/system::leader-locking-kube-scheduler                      â”‚   â”‚   â”‚ 1 â”‚   â”‚   â”‚
â”‚ kube-system â”‚ Role/system:controller:cloud-provider                           â”‚   â”‚   â”‚ 1 â”‚   â”‚   â”‚
â”‚ kube-public â”‚ Role/system:controller:bootstrap-signer                         â”‚   â”‚   â”‚ 1 â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/edit                                                â”‚ 2 â”‚ 7 â”‚ 1 â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:endpointslicemirroring-controller â”‚   â”‚ 1 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:generic-garbage-collector         â”‚ 1 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:expand-controller                 â”‚ 1 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:job-controller                    â”‚   â”‚ 1 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:root-ca-cert-publisher            â”‚   â”‚   â”‚ 1 â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:persistent-volume-binder          â”‚ 1 â”‚ 2 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:kube-scheduler                               â”‚   â”‚ 2 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:kube-controller-manager                      â”‚ 5 â”‚ 2 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:resourcequota-controller          â”‚ 1 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:namespace-controller              â”‚ 1 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:replicaset-controller             â”‚   â”‚ 1 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/cluster-admin                                       â”‚ 2 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/admin                                               â”‚ 3 â”‚ 7 â”‚ 1 â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:aggregate-to-admin                           â”‚ 1 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:replication-controller            â”‚   â”‚ 1 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:endpointslice-controller          â”‚   â”‚ 1 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:deployment-controller             â”‚   â”‚ 2 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:horizontal-pod-autoscaler         â”‚ 2 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:node                                         â”‚ 1 â”‚   â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:endpoint-controller               â”‚   â”‚ 1 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:controller:cronjob-controller                â”‚   â”‚ 2 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/local-path-provisioner-role                         â”‚ 1 â”‚ 1 â”‚   â”‚   â”‚   â”‚
â”‚             â”‚ ClusterRole/system:aggregate-to-edit                            â”‚ 2 â”‚ 7 â”‚ 1 â”‚   â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
Severities: C=CRITICAL H=HIGH M=MEDIUM L=LOW U=UNKNOWN
```

ã‚ã¡ã‚ƒã‚ã¡ã‚ƒå ±å‘Šã•ã‚Œã¦ã„ã¾ã™ã€‚ã€‚ã€‚ã€‚ã€‚
æ¥­å‹™ã§ã“ã‚“ãªã«ã§ã‚‹ã¨æ°—çµ¶ã—ãã†ã§ã™ã€‚


ã‚ã¨ã€å˜ä½“ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ã‚‚å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
å…ˆç¨‹åŒæ§˜ã€nginx ã® Deploymentã«å¯¾ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

è„†å¼±æ€§ã€Misconfigurationã€Secretsã®ã‚¹ã‚­ãƒ£ãƒ³ã‚’ä¸€åº¦ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚
å€‹åˆ¥ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚ˆã‚Šä¾¿åˆ©ãã†ã§ã™ã€‚ãŒã€é™çš„ã€å‹•çš„ãƒã‚§ãƒƒã‚¯ã¯ã‚±ãƒ¼ã‚¹ã«ã‚ˆã£ã¦è¦å¦ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã®ã§
ã‚±ãƒ¼ã‚¹ã«å¿œã˜ã¦åˆ©ç”¨ã™ã‚‹ã®ãŒã‚ˆã„ã®ã§ã¯ãªã„ã‹ãªã€ã¨æ€ã„ã¾ã™ã€‚

```bash
$ trivy kubernetes deployment/nginx-deployment
1 / 1 [----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% 0 p/s

nginx:1.14.2 (debian 9.8)

Total: 414 (UNKNOWN: 7, LOW: 159, MEDIUM: 86, HIGH: 106, CRITICAL: 56)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Library         â”‚  Vulnerability   â”‚ Severity â”‚   Installed Version    â”‚     Fixed Version      â”‚                            Title                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ apt                    â”‚ CVE-2020-27350   â”‚ MEDIUM   â”‚ 1.4.9                  â”‚ 1.4.11                 â”‚ apt: integer overflows and underflows while parsing .deb     â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ packages                                                     â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ https://avd.aquasec.com/nvd/cve-2020-27350                   â”‚
â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        â”‚ CVE-2020-3810    â”‚          â”‚                        â”‚ 1.4.10                 â”‚ Missing input validation in the ar/tar implementations of    â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ APT before v ......                                          â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ https://avd.aquasec.com/nvd/cve-2020-3810                    â”‚
â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        â”‚ CVE-2011-3374    â”‚ LOW      â”‚                        â”‚                        â”‚ It was found that apt-key in apt, all versions, do not       â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ correctly...                                                 â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ https://avd.aquasec.com/nvd/cve-2011-3374                    â”‚
...
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ zlib1g                 â”‚ CVE-2022-37434   â”‚ CRITICAL â”‚ 1:1.2.8.dfsg-5         â”‚                        â”‚ zlib: a heap-based buffer over-read or buffer overflow in    â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ inflate in inflate.c...                                      â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ https://avd.aquasec.com/nvd/cve-2022-37434                   â”‚
â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        â”‚ CVE-2018-25032   â”‚ HIGH     â”‚                        â”‚ 1:1.2.8.dfsg-5+deb9u1  â”‚ zlib: A flaw found in zlib when compressing (not             â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ decompressing) certain inputs...                             â”‚
â”‚                        â”‚                  â”‚          â”‚                        â”‚                        â”‚ https://avd.aquasec.com/nvd/cve-2018-25032                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

default-Deployment-nginx-deployment-941555502.yaml (kubernetes)

Tests: 78 (SUCCESSES: 66, FAILURES: 12, EXCEPTIONS: 0)
Failures: 12 (UNKNOWN: 0, LOW: 10, MEDIUM: 2, HIGH: 0, CRITICAL: 0)

MEDIUM: Container 'nginx' of Deployment 'nginx-deployment' should set 'securityContext.allowPrivilegeEscalation' to false
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 default-Deployment-nginx-deployment-941555502.yaml:129-137
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 129 â”Œ                 - image: nginx:1.14.2
 130 â”‚                   imagePullPolicy: IfNotPresent
 131 â”‚                   name: nginx
 132 â”‚                   ports:
 133 â”‚                     - containerPort: 80
 134 â”‚                       protocol: TCP
 135 â”‚                   resources: {}
 136 â”‚                   terminationMessagePath: /dev/termination-log
 137 â””                   terminationMessagePolicy: File
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
...

```

ã‚ã¨ã¯ã€[SBOM](https://aquasecurity.github.io/trivy/v0.31.2/docs/sbom/)ã‚„[License](https://aquasecurity.github.io/trivy/v0.31.2/docs/licenses/scanning/)ã®ã‚¹ã‚­ãƒ£ãƒ³
æœ€è¿‘ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸ[ã‚¯ãƒ©ã‚¦ãƒ‰ã®ã‚¹ã‚­ãƒ£ãƒ³](https://aquasecurity.github.io/trivy/v0.31.2/docs/cloud/aws/scanning/)ã‚‚ã‚ã‚Šã¾ã™ã­ã€‚

æ°—ã¥ã„ãŸã‚‰ã„ã‚ã‚“ãªäº‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ãŸã®ã§ã³ã£ãã‚Šã—ã¾ã—ãŸã€‚
æ°—ãŒå‘ã„ãŸã‚‰ã€ä»–ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

